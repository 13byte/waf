# Backend Environment Configuration
# Copy this file to .env and update with your values

# ============================================
# Database Configuration
# ============================================
DB_HOST=database
DB_PORT=3306
DB_NAME=waf_test_db
DB_USER=waf_user
DB_PASSWORD=change_this_password

# ============================================
# Security Configuration
# ============================================
SECRET_KEY=change_this_to_random_secret_key_at_least_32_chars
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# ============================================
# Server Configuration
# ============================================
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
BACKEND_WORKERS=1
LOG_LEVEL=INFO
DEBUG=false

# ============================================
# CORS Configuration
# ============================================
CORS_ORIGINS=http://localhost,http://localhost:3000,http://localhost:5173

# ============================================
# File Upload Configuration
# ============================================
UPLOAD_DIR=/app/uploads
MAX_UPLOAD_SIZE=10485760

# ============================================
# Cache Configuration
# ============================================
CACHE_TTL_SECONDS=300
CACHE_CLEANUP_INTERVAL=600

# ============================================
# GeoIP Configuration
# ============================================
GEOIP_DB_PATH=/app/data/geoip
GEOIP_DB_FILENAME=GeoLite2-City.mmdb
GEOIP_MAX_SIZE=524288000

# ============================================
# CRS Rules Paths (for CRS rules viewer)
# ============================================
CRS_RULES_PATH=/opt/owasp-crs/rules
CUSTOM_RULES_PATH=/etc/modsecurity/custom-rules

# ============================================
# Security Thresholds
# ============================================
ANOMALY_SCORE_THRESHOLD=5
CRITICAL_SEVERITY_SCORE=90
HIGH_SEVERITY_SCORE=70
MEDIUM_SEVERITY_SCORE=40
LOW_SEVERITY_SCORE=20

# ============================================
# Attack Detection
# ============================================
ATTACK_RATE_LIMIT=100
ATTACK_TIME_WINDOW=60
BLOCK_DURATION=3600
MAX_REQUESTS_PER_IP=1000

# ============================================
# Database Pool Configuration
# ============================================
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_RECYCLE=300
DB_POOL_PRE_PING=true

# ============================================
# Log Processing
# ============================================
LOG_PROCESSOR_BATCH_SIZE=100
LOG_PROCESSOR_INTERVAL=0.5

