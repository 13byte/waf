# WAF Security Operations Center - Environment Configuration
# Copy this file to .env and update with your values

# ============================================
# Database Configuration
# ============================================
DB_HOST=database
DB_PORT=3306
DB_NAME=waf_test_db
DB_USER=waf_user
DB_PASSWORD=change_this_password
MYSQL_ROOT_PASSWORD=change_this_root_password

# ============================================
# Backend Configuration
# ============================================
# Server
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
BACKEND_WORKERS=1

# Security
SECRET_KEY=change_this_to_random_secret_key_at_least_32_chars
ACCESS_TOKEN_EXPIRE_MINUTES=30
ALGORITHM=HS256

# CORS
CORS_ORIGINS=http://localhost,http://localhost:3000,http://localhost:5173

# File Upload
MAX_UPLOAD_SIZE=10485760
UPLOAD_DIR=/app/uploads

# Cache
CACHE_TTL_SECONDS=300
CACHE_CLEANUP_INTERVAL=600

# GeoIP
GEOIP_DB_PATH=/app/data/geoip
GEOIP_DB_FILENAME=GeoLite2-City.mmdb
GEOIP_MAX_SIZE=524288000

# ============================================
# Frontend Configuration
# ============================================
VITE_API_BASE_URL=/api
VITE_WS_URL=ws://localhost/api/ws
VITE_APP_TITLE=WAF Security Operations Center
VITE_ENVIRONMENT=production

# Frontend Server
FRONTEND_HOST=0.0.0.0
FRONTEND_PORT=3000
FRONTEND_DEV_PORT=5173

# ============================================
# Log Processor Configuration
# ============================================
LOG_FILE_PATH=/var/log/modsecurity/audit.log
STATE_FILE_PATH=/app/data/log_processor.state
LOG_PROCESSOR_INTERVAL=0.5
LOG_PROCESSOR_BATCH_SIZE=100
HEALTH_CHECK_URL=http://backend:8000/health

# ============================================
# ModSecurity/WAF Configuration
# ============================================
MODSEC_RULE_ENGINE=on
PARANOIA=1
ANOMALY_INBOUND=5
ANOMALY_OUTBOUND=4
BLOCKING_PARANOIA=1
MODSEC_AUDIT_LOG=/var/log/modsecurity/audit.log
MODSEC_AUDIT_LOG_FORMAT=JSON
MODSEC_AUDIT_LOG_TYPE=Serial
MODSEC_AUDIT_LOG_PARTS=ABIJDEFHZ
MODSEC_DEBUG_LOG=/var/log/modsecurity/debug.log
MODSEC_DEBUG_LOGLEVEL=0

# CRS Rules
CRS_RULES_PATH=/opt/owasp-crs/rules
CUSTOM_RULES_PATH=/etc/modsecurity/custom-rules
BLOCKING_RULE_ID=949110

# ============================================
# Docker Network Configuration
# ============================================
COMPOSE_PROJECT_NAME=waf
DOCKER_NETWORK=waf_network
DOCKER_RESTART_POLICY=unless-stopped

# ============================================
# Monitoring & Logging
# ============================================
LOG_LEVEL=INFO
DEBUG=false
ENABLE_METRICS=true
METRICS_PORT=9090

# ============================================
# Security Thresholds
# ============================================
ANOMALY_SCORE_THRESHOLD=5
CRITICAL_SEVERITY_SCORE=90
HIGH_SEVERITY_SCORE=70
MEDIUM_SEVERITY_SCORE=40
LOW_SEVERITY_SCORE=20

# Attack Detection
ATTACK_RATE_LIMIT=100
ATTACK_TIME_WINDOW=60
BLOCK_DURATION=3600
MAX_REQUESTS_PER_IP=1000

# ============================================
# Database Pool Configuration
# ============================================
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_RECYCLE=300
DB_POOL_PRE_PING=true